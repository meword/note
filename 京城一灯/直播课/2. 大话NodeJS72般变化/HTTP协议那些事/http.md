### 浏览器行为与HTTP协议

处理流程：

1. 输入网址并回车
2. dns解析域名
3. 浏览器发送HTTP请求
4. 服务器处理请求
5. 服务器返回HTML响应
6. 浏览器处理HTML页面
7. 继续请求其他资源



#### 策略路由

策略路由，是一种比基于目标网络进行路由路由更加灵活的数据包路由转发机制。路由器将通过路由图决定如何对需要路由的数据包进行处理，路由图决定了一个数据包的下一跳转发路由器



**概念**

应用策略路由，必须要制定策略路由使用的路由图，并且要创建路由图。一个路由图由很多条策略组成，每个策略都定义了 1 个或多个的匹配规则和对应操作。一个借口应用策略路由后，将对该接口接收到的所有包进行检查，不符合路由图任何策略的数据包将按照通常的路由转发进行处理，符合路由图中某个策略的数据包就按照该策略中定义的操作进行处理

策略路由可以使数据包按照用户指定的策略进行转发。对于某些管理目的，如Qos需求或VPN拓扑结构，要求某些路由必须经过特定的路径，就可以使用策略路由。例如：一个策略可以指定某个网络发出的数据包只能转发到某个特定的接口



### 什么是HTTP协议

HTTP是超文本传输协议，从www服务器传输到本地浏览器的一种传输协议，网站是基于HTTP协议的，例如网站的图片、css、js等都是基于HTTP协议进行传输的

HTTP协议(协议是一套规范)是由客户机到服务器的请求(Request)和从服务器到客户 机的响应(Response)进行约束和规范

``` text
HTTP/0.9 -> 1991	(互联网开始展露手脚)(get、post)

HTTP/1.0 -> 1996	(美国互联网行业兴起)

HTTP/1.1 -> 1999	(现在使用的都基本上是1.1的)

HTTPS(HTTPS也是基于HTTP/1.1的)

HTTP/2 -> 2015		(2是在1.1的基础之上被制定出来的)

HTTP/3	(现在正在制定)
```





### 了解TCP/IP协议栈

协议栈分为两个标准：

+ 纸面上的标准(ISO/OSI，国际标准化组织制定的协议)
+ 事实上的标准(TCP/IP协议栈)
  + 为什么这是事实上的标准呢？因为这个 TCP/IP 协议栈是逐渐发展起来的，发展起来的时候很多地方没有考虑周全，有很多缺陷，但是在发展过程中很多基础设施已经建立起来了，想改变它是非常难的，你不能把这些硬件设施全都给推倒重来，所以国际化标准组织就建立了一套标准规范(ISO/OSI)，事实上却仍然在使用(TCP/IP)协议



ISO/OSI 协议分为：

+ 应用层（为用户提供所需要的各种服务，例如：HTTP、FTP、DNS、SMTP(邮件协议)等）（提供接口）
+ 表示层（提供本协议的数据处理）
+ 会话层（维持通信状态   ）
+ 传输层（为应用层实体提供端到端的通信功能，保证数据包的顺序传送及数据的完整性，该层定义了两个主要的协议：传输控制协议(TCP)和用户数据报协议(UDP)）
+ 网络层（主要解决主机到主机的通信问题。IP协议是网际互联层最重要的协议）
+ 数据链路层
+ 物理层



TCP/IP 协议分为：

+ 应用层（为用户提供所需要的各种服务，例如：HTTP、FTP、DNS、SMTP等）
+ 传输层（为应用层实体提供端到端的通信功能，保证数据包的顺序传送及数据的完整性，该层定义了两个主要的协议：传输控制协议(TCP)和用户数据报协议(UDP)）
+ 网络层（主要解决主机到主机的通信问题。IP协议是网际互联层最重要的协议）
+ 网络接口层（网线、网卡）（负责监视数据在主机和网络之间的交换）



ISO/OSI 和 TCP/IP 不同之处：

+ ISO/OSI 和 TCP/IP 协议栈最大的不同就是 ISO/OSI 把应用层划分的更加详细了，因为在设计 TCP/IP 的时候没有考虑的那么详细，所以就导致了 HTTP协议 有天生的缺陷：不能保持会话，它只是一个无状态协议





### HTTP 在 TCP/IP 协议栈中的位置

**http：**

http协议 就在应用层上，但是 http 协议本身不是很安全，因为 http 传输的是明文，也就是不经过加密的数据，后来考虑到安全性，就给 http协议 加密，加密只能在应用层偏底层的位置加，加了 TLS、SSL协议加密层

  

**https：**

http协议 本身是不完整的协议，后来加上了TLS、SSL协议加密层就摇身一变，变成了 https协议



**无状态：**

http属于无状态的协议，服务器不能实时知道客户端的状态，不能够维持住会话，这就叫做无状态



**http协议 和 https协议 的区别：**就是 https协议 多加了 TLS、SSL协议加密层

目前在浏览器地址栏里面看到使用的是http协议，那么一般就是 http1.1 的版本，也有个别是 http1.0（比如python里面起服务器）

大量的网站正在向 http2 进行迁移，http2 在 http1.1 的基础上加了一些新的特性，同时把 https 里面的加密的整合在一起

所以在浏览器地址上看到的 https，可能是 https 协议，也可能是 http2.0 协议



**默认端口**：http 默认端口号为80、https 默认端口号为443、http2.0 默认端口为443







### HTTP 的工作过程

一次HTTP操作称为一个事务，其工作过程课分为四步：

> 事务的概念：比如要完成一样工作，那么这个工作可以分解成若干个步骤，为了完成这个工作，必须一个一个串行的在完成步骤，当我们正在完成步骤的时候，只要其中某一个步骤失败了，就可以认为我们整个工作失败了，凡是具有这种特征的就叫做事务

1. 首先客户机与服务器需要建立连接。只要单击某个超级链接，HTTP的工作开始 
2. 建立链接后，客户机发送一个请求给服务器，请求方式的格式为：统一资源标识符(URL)、协议版本号 后边是 MIME 信息包括请求修饰符、客户机信息和可能的内容
3. 服务器接到请求后，给予相应的相应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是 MIME 信息包括服务器信息、实体信息和可能的内容
4. 客户端接收服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机与服务器断开连接

如果在以上过程中的某一步出现错误，那么产生错误的信息将返回到客户端上，由显示屏输出。对于用户来说，这些过程是由 HTTP 自己完成的，用户只要用鼠标点击，等待信息显示就可以了





### 请求与相应

HTTP请求组成：请求行、消息报头、请求正文

HTTP响应组成：状态行、消息报头、响应正文

请求行组成：以一个 方法符号(get、post..等) 开头，后面跟着请求的 URI(资源真正路径) 和 协议(http1.0、http1.1、https、http2.0) 的版本

状态行组成：服务器HTTP协议的版本，服务器发回的相应状态代码和状态代码的文本描述





### 请求方法

> RESTful：接口定义协议
>
> RPC：远程调用协议 

+ GET：请求获取Request-URI所标识的资源
+ POST：在Request-URI所标识的资源后附加新的数据
+ HEAD：请求获取由Request-URI所标识的资源的响应消息报头
+ PUT：请求服务器存储一个资源，并用Request-URI作为其标识
+ DELETE：请求服务器删除Request-URI所标识的资源
+ TRACE：请求服务器回送收到的请求消息，主要用于测试或诊断
+ CONNECT：HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器
+ OPTIONS：请求查询服务器的性能，或者查询与资源相关的选项和需求





### HTTP 状态码

状态码由三位数字组成，第一个数字定义了相应的类别，且有五种：

+ 1xx：指示消息 -> 表示请求已接收，继续处理
  + 异步操作（web端用不到1xx的状态码）
+ 2xx：成功 -> 表示请求已被成功接收、理解、接收
+ 3xx：重定向 -> 要完成请求必须进行更进一步的操作
  + 本地重定向：重定向到本地的缓存里面去
  + 服务器重定向：资源移动位置，会去请求服务器移动到的那个位置的资源地址
+ 4xx：客户端错误 -> 请求有语法错误或请求无法实现
+ 5xx：服务器端错误 -> 服务器未能实现合法的请求





